pipeline {
	agent any
	stages {
		stage('clean') {
			steps {
				checkout scm
				sh "cd 'tomcat' ; mvn 'clean'"
			}
		}
		stage('compile') {
			steps {
				sh "cd 'tomcat' ; mvn 'compile'"
			}
		}
		stage('findbugs') {
			steps {
				sh "cd 'tomcat' ; mvn site"
			}
		}
		stage('pmd') {
			steps {
				sh "cd 'tomcat' ; mvn pmd:check"
			}
		}
		stage('test') {
			steps {
				// Since `emma` needs the tests for generating test coverage
				// reports, its target executes the test-target as well.
				// That's why we don't need the `mvn test`-target anymore
				sh "cd 'tomcat' ; mvn emma:emma"
			}
		}
		stage('assembly') {
			steps {
				sh "cd 'tomcat' ; mvn clean compile assembly:single"
			}
		}
	}
}

